<% if @payment.errors.any? %>
  $('form.edit_payment').replaceWith('<%= j render 'form' %>');
  $('#modal').find('[autofocus]').focus();
<% else %>
  $('#modal').modal('hide');
  $('#modal').remove();

  $('[data-payment=\"<%= @payment.id %>\"]').replaceWith(
    '<%= j render @payment %>'
  );

  $('[data-progress=\"<%= @loan.to_param %>\"]').replaceWith('<%= j loan_progress_info(@loan) %>');
  $('[data-debt=\"<%= @loan.to_param %>\"]').replaceWith(
    '<%= j render(partial: 'loans/debt', locals: { loan: @loan } ) %>'
  );

  $(document).ready(function() {
    $('[data-toggle="popover"]').popover( { trigger: 'hover' } );
  });
<% end %>
