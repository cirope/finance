<% if @customer.persisted? %>
  if ($('#modal form').length == 1) {
    $('#modal').on('hidden.bs.modal', function(e) {
      $('#modal').remove();
    }).modal('hide');
  } else {
    $('#modal form.new_customer').remove();
    $('#modal .modal-title').text('<%= j t('customers.new.title') %>');
    $('#modal form').show().find('[autofocus]').focus();
  }

  input = $('input[data-autocomplete-update-after]');
  input.val('<%= @customer %>');
  $(input.data('autocompleteTarget')).val('<%= @customer.id %>');
<% else %>
  $('#new_customer').replaceWith('<%= j render 'form' %>');
<% end %>
